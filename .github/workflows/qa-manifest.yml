# Copyright (c) 2021-2025 TiaC Systems
# Copyright (c) 2021 Li-Pro.Net
# SPDX-License-Identifier: Apache-2.0

name: QA Manifest Check and Labeler

on:
  pull_request:
    types: [opened, synchronize, reopened]
    paths:
      - 'submanifests/*.yml'
      - 'west.yml'

jobs:
  qa-manifest:
    name: Run manifest checks points to patch series (PR)
    runs-on: ubuntu-24.04
    defaults:
      run:
        shell: bash

    steps:
      - name: Checkout the code
        uses: actions/checkout@v6
        with:
          fetch-depth: 0
          show-progress: true
          path: workspace/bridle
          ref: ${{ github.event.pull_request.head.sha }}

      - name: Run manifest check
        uses: zephyrproject-rtos/action-manifest@v2.0.0
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          checkout-path: 'workspace/bridle'
          manifest-path: 'west.yml'
          label-prefix: 'manifest-'
          verbosity-level: '1'
          labels: 'manifest'
          dnm-labels: 'DNM'
